<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WebSocket Test</title>
</head>
<body>
  <h1>WebSocket Test</h1>
  <script>
    // Token va room_name ni o'zingizga moslang
    const token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzYwNDMyMDk4LCJpYXQiOjE3NTk4MjcyOTgsImp0aSI6IjFjNDZiZTQzODRmMzRjZTVhZjE5NzAyMzY3NzhmMTgwIiwidXNlcl9pZCI6ImRkZGU1MTc3LTk4NDUtNGUwMy05ZmM2LTI0NTQwYWUxOTZiMSJ9.oqSxg-7Kk7z3Jz_FD4j_yQvn_aNAznKWWvI2xmXgPTk";
    const roomName = "4877de8f-d4a3-49cf-99df-c05962331337";

    // Agar lokal server bo'lsa:
    // const socketUrl = `ws://127.0.0.1:8000/ws/chat/${roomName}/?token=${token}`;
    
    // Agar prod bo'lsa (https bo'lgani uchun wss ishlatish kerak):
    const socketUrl = `wss://api.ifoda-shop.uz/ws/chat/${roomName}/?token=${token}`;

    const chatSocket = new WebSocket(socketUrl);

    // Ulanish ochilganda
    chatSocket.onopen = function () {
      console.log("WebSocket connected ✅");
      chatSocket.send(JSON.stringify({
        text: "Salom!",
        role: "QUESTION",
        content_type: "TEXT"
      }));
    };

    // Serverdan xabar kelganda
    chatSocket.onmessage = function (event) {
      console.log("Message received:", event.data);
    };

    // Xatolik bo'lsa
    chatSocket.onerror = function (error) {
      console.error("WebSocket error:", error);
    };

    // Ulanish yopilganda
    chatSocket.onclose = function (event) {
      console.log("WebSocket closed ❌", event);
    };
  </script>
</body>
</html>
